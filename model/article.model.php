<?phpdefined('haipinlegou') or exit('Access Invalid!');class articleModel{		public function getArticleList($condition,$page=''){		$condition_str = $this->_condition($condition);		$param = array();		$param['table'] = 'article';		$param['where'] = $condition_str;		$param['limit'] = $condition['limit'];		$param['order']	= (empty($condition['order'])?'article_sort desc,article_time desc':$condition['order']);		$result = Db::select($param,$page);		return $result;	}			public function getJoinList($condition,$page=''){		$result	= array();		$condition_str	= $this->_condition($condition);		$param	= array();		$param['table'] = 'article,article_class';		$param['field']	= empty($condition['field'])?'*':$condition['field'];;		$param['join_type']	= empty($condition['join_type'])?'left join':$condition['join_type'];		$param['join_on']	= array('article.ac_id=article_class.ac_id');		$param['where'] = $condition_str;		$param['limit'] = $condition['limit'];		$param['order']	= empty($condition['order'])?'article.article_sort':$condition['order'];		$result = Db::select($param,$page);		return $result;	}		private function _condition($condition){		$condition_str = '';				if ($condition['article_show'] != ''){			$condition_str .= " and article.article_show = '". $condition['article_show'] ."'";		}		if ($condition['ac_id'] != ''){			$condition_str .= " and article.ac_id = '". $condition['ac_id'] ."'";		}		if ($condition['ac_ids'] != ''){			$condition_str .= " and article.ac_id in(". $condition['ac_ids'] .")";		}		if ($condition['like_title'] != ''){			$condition_str .= " and article.article_title like '%". $condition['like_title'] ."%'";		}		if ($condition['home_index'] != ''){			$condition_str .= " and (article_class.ac_id <= 7 or (article_class.ac_parent_id > 0 and article_class.ac_parent_id <= 7))";		}        if ($condition['is_show'] != ''){            $condition_str .= " and article_class.is_show = ".$condition['is_show'];        }        if ($condition['ac_parent_id'] === 0 ){            $condition_str .= " and article_class.ac_parent_id = '".$condition['ac_parent_id']."'";        }				return $condition_str;	}			public function getOneArticle($id){		if (intval($id) > 0){			$param = array();			$param['table'] = 'article';			$param['field'] = 'article_id';			$param['value'] = intval($id);			$result = Db::getRow($param);			return $result;		}else {			return false;		}	}    /**     * 获取所有文章     */    public function getAllArticle($param,$page='',$field='*')    {        $condition_str      = $this->_condition($param);        $array              = array();        $array['field']     = $field;        $array['table']     = 'article,article_class';        $array['join_type'] = empty($param['join_type'])? 'LEFT JOIN' : $param['join_type'];        $array['join_on']   = array('article.ac_id = article_class.ac_id');        $array['where']     = $condition_str;        $array['order']     = $param['order'] ? $param['order'] : 'article.article_id';        $array['limit']     = $param['limit'];        return Db::select($array,$page);    }    /**     *     */	public function articleTree()    {        $data = array();        $data['is_show'] = 1;        $data['ac_parent_id'] = 0;        $data['article_show'] = 1;        $data['order'] = 'article_class.ac_sort DESC,article.article_sort DESC';        $field ='article.article_id,article.ac_id,article.article_title,article_class.ac_name,article_class.ac_code,article_class.ac_parent_id';        //$field = "*";        $res = $this->getAllArticle($data,'',$field);        $tmp = [];        if(!empty($res) && is_array($res)) {            foreach($res as $key=>$val) {                $tmp[$val['ac_id']][] = $val;            }        }        return $tmp;    }	public function add($param){		if (empty($param)){			return false;		}		if (is_array($param)){			$tmp = array();			foreach ($param as $k => $v){				$tmp[$k] = $v;			}			$result = Db::insert('article',$tmp);			return $result;		}else {			return false;		}	}			public function update($param){		if (empty($param)){			return false;		}		if (is_array($param)){			$tmp = array();			foreach ($param as $k => $v){				$tmp[$k] = $v;			}			$where = " article_id = '". $param['article_id'] ."'";			$result = Db::update('article',$tmp,$where);			return $result;		}else {			return false;		}	}			public function del($id){		if (intval($id) > 0){			$where = " article_id = '". intval($id) ."'";			$result = Db::delete('article',$where);			return $result;		}else {			return false;		}	}	}