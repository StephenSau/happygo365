<?phpdefined('haipinlegou') or exit('Access Invalid!');class activityModel{		public function getList($condition,$page=''){		$param	= array();		$param['table']	= 'activity';		$param['where']	= $this->getCondition($condition);		$param['order']	= $condition['order'] ? $condition['order'] : 'activity_id';		return Db::select($param,$page);	}		public function add($input){		return Db::insert('activity',$input);	}    /**     * 获取活动商品     * @param $param=[]     * @return []|bool     */	public function getLimtGoodsList($param)    {        $condition	= array();        $condition['table']	= $param['table'];        $condition['join_type']	=$param['join'];        $condition['join_on']	= $param['join_on'];        $condition['where']	= $param['where'];        $condition['limit']=$param['limit'];        $condition['order']=$param['order'];        return Db::select($condition);    }	public function update($input,$id){		return Db::update('activity',$input," activity_id='$id' ");	}		public function del($id){		return Db::delete('activity','activity_id in('.$id.')');	}		public function getOneById($id){		return Db::getRow(array('table'=>'activity','field'=>'activity_id','value'=>$id));	}		public function getJoinList($condition,$page=''){		$param	= array();		$param['table']	= 'activity,activity_detail';		$param['join_type']	= empty($condition['join_type'])?'right join':$condition['join_type'];		$param['join_on']	= array('activity.activity_id=activity_detail.activity_id');		$param['where']	= $this->getCondition($condition);		$param['order']	= $condition['order'];		return Db::select($param,$page);	}		private function getCondition($condition){		$conditionStr	= '';		if($condition['activity_id'] != ''){			$conditionStr	.= " and activity.activity_id='{$condition['activity_id']}' ";		}		if($condition['activity_type'] != ''){			$conditionStr	.= " and activity.activity_type='{$condition['activity_type']}' ";		}		if($condition['activity_state'] != ''){			$conditionStr	.= " and activity.activity_state = '{$condition['activity_state']}' ";		}		if(isset($condition['activity_id_in'])){			if ($condition['activity_id_in'] == ''){				$conditionStr	.= " and activity_id in('')";			}else{				$conditionStr	.= " and activity_id in({$condition['activity_id_in']}) ";			}		}		if($condition['activity_title'] != ''){			$conditionStr	.= " and activity.activity_title like '%{$condition['activity_title']}%' ";		}		if ($condition['activity_enddate_greater'] != ''){			$conditionStr	.= " and activity.activity_end_date < '{$condition['activity_enddate_greater']}'";		}		if ($condition['activity_enddate_greater_or'] != ''){			$conditionStr	.= " or activity.activity_end_date < '{$condition['activity_enddate_greater_or']}'";		}		if($condition['activity_daterange'] != ''){			$conditionStr .= " and (activity.activity_end_date >= '{$condition['activity_daterange']['startdate']}' and activity.activity_start_date <= '{$condition['activity_daterange']['enddate']}')";		}		if($condition['opening']){			$conditionStr	.= " and (activity.activity_start_date <=".time()." and activity.activity_end_date >= ".time()." and activity.activity_state =1)";		}		return $conditionStr;	}}